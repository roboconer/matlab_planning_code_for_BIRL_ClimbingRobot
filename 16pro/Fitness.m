function [ f ] = Fitness( particle,index,iter,n_size,ps1,ps2,ps3,ps4)
%FITNESS Summary of this function goes here
%   Detailed explanation goes here
n=length(n_size);
P=zeros(n,3);
T=zeros(n,4);

pstart = [4.0656,6.91087,1.91813];
pend = [5.70673 6.3332 9.46937];
N=zeros(n_size);
%points=zeros(3,1000,n);              %初始化储存点的矩阵
%pointassignment;                                                   %导入点数据    
s=0;
%p10=[2.01168,3.40068,0]; d11=[-0.0116841,0.0993151,0]; d12=[-1,-0.5,0];d13=[-0.0242536,-0.0970143,0];
%p20=[1.85681,4.09369,2.21794]; d21=[-0.0568075,0.00631194,0.0820553];d22=[-0.209991,-0.114541,-0.439072];
%p30=[0.336155,1.74347,1.63845]; d31=[-0.0361551,-0.343473,0.361551]; d32=[-0.0586395,-0.762314,-1.17279];% d33=[-0.310668,-0.0414224,-0.248535];
%p40=[1.26475,0.967625,2.2539];  d41=[0.535251,-0.267625,0.0433986];d42=[0.2,-0.2,-0.097297];d43=[-0.310668,-0.0414224,-0.248535];
for i=1:n
    N(i) = ceil(particle(index,i,iter)*n_size(1,i));
end
P(1,:)= ps1(N(1),:);
P(2,:)= ps2(N(2),:);
P(3,:)= ps3(N(3),:);
P(4,:)= ps4(N(4),:);
    
%for i=1:n
    %T(i,1)=particle(index,i,iter)*n_size(1,i);
   % if T(i,1)>2
       % T(i,2:4)=[1,1,T(i,1)-2];
    %end
    % if T(i,1)>1
       % T(i,2:4)=[1,T(i,1)-1,0];
    % end
     %if T(i,1)>0 && T(i,1)<1
       % T(i,2:4)=[T(i,1),0,0];
     %end
%end
%     P(1,:)=p10+T(1,2)*d11+T(1,3)*d12+T(1,4)*d13;
%     P(2,:)=p20+T(2,2)*d21+T(2,3)*d22;
   % P(3,:)=p30+T(3,2)*d31+T(3,3)*d32;%+T(3,4)*d33;
   % P(4,:)=p40+T(4,2)*d41+T(4,3)*d42+T(4,4)*d43;
    s1=sqrt((pstart(1,1)-P(1,1))^2+(pstart(1,2)-P(1,2))^2+(pstart(1,3)-P(1,3))^2);
    s2=sqrt((pend(1,1)-P(n,1))^2+(pend(1,2)-P(n,2))^2+(pend(1,3)-P(n,3))^2);
for i=1:n-1
    s0=sqrt((P(i+1,1)-P(i,1))^2+(P(i+1,2)-P(i,2))^2+(P(i+1,3)-P(i,3))^2);
    s=s+s0;
end   
f=s1+s+s2;
end